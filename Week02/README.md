学习笔记

go的接口
Go的接口提供了一种指定对象行为的方法。一个类型可以实现多个接口。



## 什么时候使用error，什么时候使用panic
单个请求级别的异常，比如某个请求某个rpc服务超时，这种肯定会选择error级别。这种情况下，只是单个请求的异常，肯定不能让整个服务进程退出。
一些重要的配置加载失败，且无可用的降级数据时，这个时候可能会选择panic。
我觉得判断的维度主要有两个
1. 影响范围
    单次请求，就无所谓。但如果影响全部请求，这种肯定是不能让服务起来，然后提供错误的服务的。
2. 能不能兜住
    有些情况是可以兜住，通过降级啊什么的，但是有些情况是兜不住的，比如死循环这种

## 正确的姿势（不透明的处理）
调用者非必要的情况下，不需要关心到底错在哪里了，只需要知道对了，还是错了
如果对了，该干啥干啥
如果错了，看自己能不能兜住，走降级或者什么其他方式，能，就吞掉错误，不能，就向上传递
如果逻辑需要，一定要知道错误原因，不要通过断言的形式来判断，最好让服务提供方提供一个判断错误类型的方法。

## 怎么写出舒服的错误处理
1. 缩进，有错误的就除去，保证正常流程的代码是主逻辑，没什么缩进的，好看一点
2. 在有错误就返回错误，没错误就返回nil的场景，直接return err就好了，没必要再写一遍脱裤子放屁
3. 不要乱用方法，认真阅读人家package的文档，找到最合适的方法，免得自己造轮子，代码写的也不优雅（可能还有性能的问题和bug)
4. 通过消除错误来消除错误处理，这个需要思考下的，提供方法的人，可以先将错误信息存储起来，每次发生调用的时候先判断之前有没有错误发生，如果有错误，就直接返回
5. pkg/errors


## wrap



问题
panic和exception到底有啥不同？
只能看到相同的点：
1. 都有被滥用的风险
1. 都是服务提供方跑出来的，都有可能被上层调用者处理掉（吞掉：catch住或者recovery）

